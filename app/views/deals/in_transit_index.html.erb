<div class="container">
  <h2>(<%= @deals.count %>) In-Transit</h2>
  <div>
    <%= link_to carrier_shipments_path, class: "btn btn-primary" do %>
      My Shipments
    <% end %>

    <%= link_to carrier_shipments_pre_transit_path, class: "btn btn-primary" do %>
      Pre-Transit
    <% end %>

    <%= link_to carrier_shipments_in_transit_path, class: "btn btn-primary" do %>
      In-Transit
    <% end %>

    <%= link_to carrier_shipments_post_transit_path, class: "btn btn-primary" do %>
      Post-Transit
    <% end %>
  </div>

  <% if @deals.present? %>
    <% @deals.each do |deal| %>
      <div>
        <div>
          Deal-ID:<%= deal.id %>
        </div>
        <div>
          Ship-ID:<%= deal.shipment.id %> <%= deal.shipment.distance %>KM <%= deal.shipment.offer_rate %>å†† <%= deal.shipment.car_type %> <%= deal.shipment.shipper.email %> | <%= deal.carrier.email %>
        </div>

        <% deal.shipment.pickups.order(created_at: :asc).each do |pickup| %>
          <div>
            P-ID:<%= pickup.id %> <%= pickup.company_name %> <%= pickup.prefecture %> <%= pickup.address %> <%= pickup.commodity %> <%= pickup.weight %>KG
          </div>
        <% end %>

        <% deal.shipment.deliveries.order(created_at: :asc).each do |delivery| %>
          <div>
            D-ID:<%= delivery.id %> <%= delivery.company_name %> <%= delivery.prefecture %> <%= delivery.address %>
          </div>
        <% end %>

        <div>
          <%= deal.created_at.getlocal.strftime("%Y/%m/%e - %H:%M%p") %> Status: <span style="color:blue"><%= deal.deal_status %></span>
        </div>

        <div>
          Transit Status: <span style="color:blue"><%= deal.shipment.transit_status %></span>
        </div>

        <div>
          <%= simple_form_for deal, url: carrier_shipments_in_transit_path do |f| %>
            <%= f.hidden_field :id, value: deal.id %>
            <%= f.button :submit, 'MOVE TO POST-TRANSIT', class: "btn btn-primary" %>
          <% end %>
        </div>
        <br>
      </div>
    <% end %>
  <% else %>
    <div>
      <p>You have no shipments in-transit yet.</p>
    </div>
  <% end %>

</div>
