<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {

      // START / CARD SELECTION
      const clickTargets = document.querySelectorAll(".cardBtn");
      const selectedCarriersInput = document.querySelector("#carriers_ids");
      const carrierIdArray = [];

      clickTargets.forEach(function(btn, i) {
        btn.addEventListener("click", function(e) {
          const clickedCard = $(e.target).closest("div.cardCarrier");
          const selectedCarrierId = clickedCard.find(".carrier__id")[0].id;
          clickedCard.toggleClass("selected");
          if(clickedCard.hasClass("selected")) {
            carrierIdArray.push(selectedCarrierId);
            selectedCarriersInput.value = carrierIdArray;
          } else if(!clickedCard.hasClass("selected")) {
            carrierIdArray.splice(carrierIdArray.indexOf(selectedCarrierId), 1);
            selectedCarriersInput.value = carrierIdArray;
          }
        });
      })

    });
  <% end %>
<% end %>