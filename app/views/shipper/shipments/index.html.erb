<div class="container">
  <h2>My Shipments</h2>

  <% if @shipments.present? %>
    <div>
      <%= link_to new_shipment_path, class: "btn btn-primary" do %>
       <i class="fa fa-table"></i> + ADD NEW SHIPMENT
      <% end %>
    </div>

    <% @shipments.each do |shipment| %>
      <div>
        <div>
          <%= link_to "Details", shipment_path(shipment) %>
          <%= link_to "Edit", edit_shipment_path(shipment) %>
          <%= link_to "Delete", shipment_path(shipment),
            method: :delete, data: { confirm: "Are you sure?" } %>
          Ship-ID:<%= shipment.id %> <%= shipment.distance %>km <%= shipment.rate %>å†† <%= shipment.car_type %> <%= shipment.shipper.email %> |
        </div>

        <% shipment.locations.order(created_at: :asc).each do |location| %>
          <% if location.is_for == 'pickup' %>
            <div>
              P-ID:<%= location.id %> <%= location.facility.name %> <%= location.commodity %> <%= location.weight %>kg (<%= location.is_for %>)
            </div>
          <% end %>
        <% end %>

        <% shipment.locations.order(created_at: :asc).each do |location| %>
          <% if location.is_for == 'delivery' %>
            <div>
              D-ID:<%= location.id %> <%= location.facility.name %> (<%= location.is_for %>)
            </div>
          <% end %>
        <% end %>

        <div>
          <% shipment.deals.each do |deal| %>
            <p><%= deal.created_at.getlocal.strftime("%Y/%m/%e - %H:%M%p") %> <%= deal.carrier.email %> <span style="color:blue"><%= deal.deal_status %></span></p>
          <% end %>
        </div>

        <br>
      </div>
    <% end %>
  <% else %>
    <div>
      <p>You have no listings yet.</p>
      <p>Add new listing to find carrier!</p>
      <%= link_to new_shipment_path, class: "btn btn-primary" do %>
       <i class="fa fa-table"></i> + ADD NEW SHIPMENT
      <% end %>
    </div>
  <% end %>

</div>
